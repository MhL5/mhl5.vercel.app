{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "useUrlState",
  "type": "registry:hook",
  "title": "useUrlState",
  "description": "A hook for managing state in the URL search parameters.",
  "files": [
    {
      "path": "src/registry/hooks/useUrlState/useUrlState.ts",
      "content": "\"use client\";\r\n\r\nimport type { Route } from \"next\";\r\nimport { usePathname, useRouter, useSearchParams } from \"next/navigation\";\r\nimport { useCallback, useEffect, useRef, useState, useTransition } from \"react\";\r\n\r\ntype Options = {\r\n  defaultValue?: string | (() => string);\r\n  history?: \"push\" | \"replace\";\r\n  /**\r\n   * If true, updates the URL using window.history (pushState/replaceState) instead of Next.js router,\r\n   * preventing a server-side render. This keeps the update fully client-side.\r\n   */\r\n  shallow?: boolean;\r\n};\r\n\r\nexport default function useUrlState(name: string, options: Options = {}) {\r\n  const optionsRef = useRef(options);\r\n  const [isPending, startTransition] = useTransition();\r\n  const searchParams = useSearchParams();\r\n  const pathname = usePathname();\r\n  const router = useRouter();\r\n  const [state, setState] = useState<string>(() => {\r\n    const value = searchParams.get(name);\r\n    if (value) return value;\r\n\r\n    const defaultValue =\r\n      optionsRef.current.defaultValue instanceof Function\r\n        ? optionsRef.current.defaultValue()\r\n        : optionsRef.current.defaultValue;\r\n\r\n    return defaultValue ?? \"\";\r\n  });\r\n\r\n  const handleSetState = useCallback(\r\n    (value: string | ((prev: string) => string)) => {\r\n      const newValue = typeof value === \"function\" ? value(state) : value;\r\n      setState(newValue);\r\n\r\n      const newPath = `${pathname}?${createQueryString({\r\n        searchParams: searchParams,\r\n        name,\r\n        value: newValue,\r\n      })}`;\r\n\r\n      startTransition(() => {\r\n        const historyMethod = optionsRef.current.history || \"push\";\r\n        if (optionsRef.current.shallow)\r\n          return window.history[`${historyMethod}State`](null, \"\", newPath);\r\n\r\n        router[historyMethod](newPath as Route, {\r\n          scroll: false,\r\n        });\r\n      });\r\n    },\r\n    [name, pathname, router, searchParams, state],\r\n  );\r\n\r\n  useEffect(() => {\r\n    const value = searchParams.get(name);\r\n    if (value) setState(value);\r\n  }, [name, searchParams]);\r\n\r\n  return [state, handleSetState, isPending] as const;\r\n}\r\n\r\ntype CreateQueryStringParams = {\r\n  searchParams: URLSearchParams;\r\n  name: string;\r\n  value: string;\r\n};\r\n\r\nfunction createQueryString({\r\n  searchParams,\r\n  name,\r\n  value,\r\n}: CreateQueryStringParams) {\r\n  const params = new URLSearchParams(searchParams.toString());\r\n  if (value) params.set(name, value);\r\n  else params.delete(name);\r\n  return params.toString();\r\n}\r\n",
      "type": "registry:hook"
    }
  ]
}