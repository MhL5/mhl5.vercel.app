{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "useUrlState",
  "type": "registry:hook",
  "title": "useUrlState",
  "description": "A hook for managing state in the URL search parameters.",
  "files": [
    {
      "path": "src/registry/hooks/useUrlState/useUrlState.ts",
      "content": "\"use client\";\n\nimport type { Route } from \"next\";\nimport { usePathname, useRouter, useSearchParams } from \"next/navigation\";\nimport {\n  useCallback,\n  useEffect,\n  useEffectEvent,\n  useRef,\n  useState,\n  useTransition,\n} from \"react\";\n\ntype Options = {\n  defaultValue?: string | (() => string);\n  history?: \"push\" | \"replace\";\n  /**\n   * If true, updates the URL using window.history (pushState/replaceState) instead of Next.js router,\n   * preventing a server-side render. This keeps the update fully client-side.\n   */\n  shallow?: boolean;\n};\n\nexport default function useUrlState(name: string, options: Options = {}) {\n  const optionsRef = useRef(options);\n  const [isPending, startTransition] = useTransition();\n  const searchParams = useSearchParams();\n  const pathname = usePathname();\n  const router = useRouter();\n  const [state, setState] = useState<string>(() => {\n    const value = searchParams.get(name);\n    if (value) return value;\n\n    const defaultValue =\n      options.defaultValue instanceof Function\n        ? options.defaultValue()\n        : options.defaultValue;\n\n    return defaultValue ?? \"\";\n  });\n\n  const handleSetState = useCallback(\n    (value: string | ((prev: string) => string)) => {\n      const newValue = typeof value === \"function\" ? value(state) : value;\n      setState(newValue);\n\n      const newPath = `${pathname}?${createQueryString({\n        searchParams: searchParams,\n        name,\n        value: newValue,\n      })}`;\n\n      startTransition(() => {\n        const historyMethod = optionsRef.current.history || \"push\";\n        if (optionsRef.current.shallow)\n          return window.history[`${historyMethod}State`](null, \"\", newPath);\n\n        router[historyMethod](newPath as Route, {\n          scroll: false,\n        });\n      });\n    },\n    [name, pathname, router, searchParams, state],\n  );\n\n  const onSearchParamValueChange = useEffectEvent((value: string) => {\n    setState(value);\n  });\n\n  useEffect(() => {\n    const value = searchParams.get(name);\n    if (value) onSearchParamValueChange(value); // updates the state when the search params change\n  }, [name, searchParams]);\n\n  return [state, handleSetState, isPending] as const;\n}\n\ntype CreateQueryStringParams = {\n  searchParams: URLSearchParams;\n  name: string;\n  value: string;\n};\n\nfunction createQueryString({\n  searchParams,\n  name,\n  value,\n}: CreateQueryStringParams) {\n  const params = new URLSearchParams(searchParams.toString());\n  if (value) params.set(name, value);\n  else params.delete(name);\n  return params.toString();\n}\n",
      "type": "registry:hook"
    }
  ],
  "meta": {
    "url": "/snippets/hooks/useUrlState"
  }
}