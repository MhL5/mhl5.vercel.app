{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "useIsVisible",
  "type": "registry:hook",
  "title": "useIsVisible",
  "description": "A hook for checking if an element is visible in the viewport using Intersection Observer API.",
  "files": [
    {
      "path": "src/registry/hooks/useIsVisible/useIsVisible.ts",
      "content": "\"use client\";\r\n\r\nimport { useCallback, useEffect, useState } from \"react\";\r\n\r\ntype UseIsVisibleOptions = {\r\n  rootMargin?: IntersectionObserverInit[\"rootMargin\"];\r\n  once?: boolean;\r\n  initialState?: boolean | (() => boolean);\r\n};\r\n\r\nexport type UseIsVisibleRef = ReturnType<typeof useIsVisible>[\"ref\"];\r\n\r\nexport default function useIsVisible({\r\n  rootMargin = \"0px\",\r\n  once = false,\r\n  initialState = false,\r\n}: UseIsVisibleOptions = {}) {\r\n  const [isVisible, setIsVisible] = useState(() => {\r\n    if (initialState instanceof Function) return initialState();\r\n    return initialState;\r\n  });\r\n  // refCallback automatically triggers when the element changes, while useRef doesn't\r\n  // using useRef can break the logic specially if the component gets rendered with a delay due to fetching ...\r\n  const [element, setElement] = useState<HTMLElement | null>(null);\r\n  const refCallback = useCallback((node: HTMLElement | null) => {\r\n    setElement(node);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!element) return;\r\n\r\n    // IntersectionObserver is async and callback can even run after the component is unmounted\r\n    // so we need to check if the component is mounted before setting the state\r\n    let isMounted = true;\r\n\r\n    const observer = new IntersectionObserver(\r\n      ([entry]) => {\r\n        if (!isMounted) return;\r\n\r\n        setIsVisible(entry.isIntersecting);\r\n        if (once && entry.isIntersecting) observer.disconnect();\r\n      },\r\n      { rootMargin },\r\n    );\r\n\r\n    observer.observe(element);\r\n\r\n    return () => {\r\n      observer.unobserve(element);\r\n      isMounted = false;\r\n    };\r\n  }, [element, rootMargin, once]);\r\n\r\n  return { isVisible, ref: refCallback };\r\n}\r\n",
      "type": "registry:hook"
    }
  ]
}