{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "TagsInput",
  "type": "registry:component",
  "title": "TagsInput",
  "description": "A component for inputting tags.",
  "dependencies": [
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "input",
    "tooltip",
    "kbd"
  ],
  "files": [
    {
      "path": "src/registry/new-york/TagsInput/TagsInput.tsx",
      "content": "\"use client\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Kbd } from \"@/components/ui/kbd\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { InfoIcon, Plus, X } from \"lucide-react\";\r\nimport {\r\n  type ChangeEvent,\r\n  type ClipboardEvent,\r\n  type ComponentProps,\r\n  type Dispatch,\r\n  type FocusEvent,\r\n  type KeyboardEvent,\r\n  type ReactNode,\r\n  type SetStateAction,\r\n  createContext,\r\n  use,\r\n  useId,\r\n  useState,\r\n} from \"react\";\r\n\r\nconst COMMA_CHARS = [\",\", \"ØŒ\"] as const;\r\n\r\ntype TagsInputContextType = {\r\n  value: string[];\r\n  onChange: (tags: string[]) => void;\r\n\r\n  inputValue: string;\r\n  setInputValue: Dispatch<SetStateAction<string>>;\r\n  error: string | null;\r\n  errorMessageId: string;\r\n\r\n  addTag: (tag: string) => void;\r\n  addTags: (tags: string[]) => void;\r\n  removeTag: (indexToRemove: number) => void;\r\n  disabled?: boolean;\r\n};\r\n\r\nconst TagsInputContext = createContext<TagsInputContextType | null>(null);\r\n\r\ntype TagsInputProviderProps = {\r\n  value: TagsInputContextType[\"value\"];\r\n  onChange: TagsInputContextType[\"onChange\"];\r\n\r\n  disabled: TagsInputContextType[\"disabled\"];\r\n  children: ReactNode;\r\n\r\n  validate?: (tag: string) => boolean;\r\n  validateMessage?: (tag: string | string[]) => string;\r\n  maxTags?: number;\r\n};\r\n\r\nfunction TagsInput({\r\n  value,\r\n  onChange,\r\n  children,\r\n  validate,\r\n  validateMessage,\r\n  disabled,\r\n  maxTags,\r\n}: TagsInputProviderProps) {\r\n  const [inputValue, setInputValue] = useState(\"\");\r\n  const [error, setError] = useState<string | null>(null);\r\n  const errorMessageId = useId();\r\n\r\n  const addTag: TagsInputContextType[\"addTag\"] = (tag) => {\r\n    const trimmedTag = tag.trim();\r\n    if (!trimmedTag) return;\r\n\r\n    // Check max tags limit\r\n    if (maxTags && value.length >= maxTags) {\r\n      setError(\r\n        `You can add up to ${maxTags} tag${maxTags === 1 ? \"\" : \"s\"} only`,\r\n      );\r\n      setInputValue(\"\");\r\n      return;\r\n    }\r\n\r\n    // Check for duplicates\r\n    if (value.includes(trimmedTag)) {\r\n      setError(`\"${tag}\" already exists`);\r\n      setInputValue(\"\");\r\n      return;\r\n    }\r\n\r\n    // Validate tag if validate function is provided\r\n    if (validate && !validate(trimmedTag)) {\r\n      setError(\r\n        validateMessage ? validateMessage(trimmedTag) : `\"${tag}\" is invalid`,\r\n      );\r\n      setInputValue(\"\");\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    onChange?.([trimmedTag, ...value]);\r\n    setInputValue(\"\");\r\n  };\r\n\r\n  const addTags: TagsInputContextType[\"addTags\"] = (tags) => {\r\n    if (!tags.length) return;\r\n\r\n    const trimmedTags = tags.map((tag) => tag.trim());\r\n    if (!trimmedTags.length) return;\r\n\r\n    // Filter empty strings, duplicates, and invalid tags\r\n    let newTags = trimmedTags.filter((tag) => tag && !value.includes(tag));\r\n    // Apply validation if provided\r\n    const invalidTags: string[] = [];\r\n    if (validate)\r\n      newTags = newTags.filter((tag) => {\r\n        if (validate(tag)) return true;\r\n        invalidTags.push(tag);\r\n        return false;\r\n      });\r\n\r\n    if (!newTags.length)\r\n      return setError(\r\n        validateMessage ? validateMessage(invalidTags) : \"No valid tags to add\",\r\n      );\r\n\r\n    if (maxTags) {\r\n      const remainingSlots = maxTags - value.length;\r\n      newTags = newTags.slice(0, remainingSlots);\r\n      if (!newTags.length)\r\n        return setError(\r\n          `You have reached the maximum number of tags (${maxTags})`,\r\n        );\r\n    }\r\n\r\n    onChange?.([...newTags, ...value]);\r\n    setError(null);\r\n    setInputValue(\"\");\r\n  };\r\n\r\n  const removeTag: TagsInputContextType[\"removeTag\"] = (indexToRemove) => {\r\n    onChange?.([\r\n      ...value.slice(0, indexToRemove),\r\n      ...value.slice(indexToRemove + 1),\r\n    ]);\r\n    setError(null);\r\n  };\r\n\r\n  return (\r\n    <TagsInputContext\r\n      value={{\r\n        errorMessageId,\r\n        value,\r\n        onChange,\r\n        inputValue,\r\n        setInputValue,\r\n        addTag,\r\n        addTags,\r\n        removeTag,\r\n        disabled,\r\n        error,\r\n      }}\r\n    >\r\n      {children}\r\n    </TagsInputContext>\r\n  );\r\n}\r\n\r\nfunction useTagsInput() {\r\n  const context = use(TagsInputContext);\r\n  if (!context)\r\n    throw new Error(\"useTagsInput must be used within a TagsInputProvider\");\r\n  return context;\r\n}\r\n\r\nfunction TagsInputInput({\r\n  onKeyDown,\r\n  onBlur,\r\n  onPaste,\r\n  onChange,\r\n  disabled: disabledProp,\r\n  ...props\r\n}: ComponentProps<typeof Input>) {\r\n  const {\r\n    inputValue,\r\n    setInputValue,\r\n    addTag,\r\n    addTags,\r\n    removeTag,\r\n    value,\r\n    error,\r\n    disabled,\r\n    errorMessageId,\r\n  } = useTagsInput();\r\n\r\n  function handleChange(e: ChangeEvent<HTMLInputElement>) {\r\n    setInputValue(e.target.value);\r\n    onChange?.(e);\r\n  }\r\n\r\n  function handleKeyDown(e: KeyboardEvent<HTMLInputElement>) {\r\n    onKeyDown?.(e);\r\n\r\n    if (e.key === \"Backspace\" && !inputValue && value.length > 0)\r\n      return removeTag(value.length - 1);\r\n\r\n    if (\r\n      e.key === \"Enter\" ||\r\n      COMMA_CHARS.includes(e.key as (typeof COMMA_CHARS)[number])\r\n    ) {\r\n      e.preventDefault();\r\n      addTag(inputValue);\r\n      return;\r\n    }\r\n  }\r\n\r\n  function handleBlur(e: FocusEvent<HTMLInputElement>) {\r\n    onBlur?.(e);\r\n\r\n    if (!inputValue.trim()) return;\r\n    addTag(inputValue);\r\n  }\r\n\r\n  function handlePaste(e: ClipboardEvent<HTMLInputElement>) {\r\n    onPaste?.(e);\r\n\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    const text = e.clipboardData.getData(\"text\").trim();\r\n    const commaToSplitBy = COMMA_CHARS.find((comma) => text.includes(comma));\r\n\r\n    if (!text) return;\r\n    if (!commaToSplitBy) return setInputValue((prev) => prev + text);\r\n\r\n    addTags(text.split(commaToSplitBy));\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2\">\r\n      <Input\r\n        {...props}\r\n        disabled={disabled || disabledProp}\r\n        value={inputValue}\r\n        onChange={handleChange}\r\n        onKeyDown={handleKeyDown}\r\n        onBlur={handleBlur}\r\n        onPaste={handlePaste}\r\n        aria-describedby={errorMessageId}\r\n        aria-invalid={!!error}\r\n      />\r\n\r\n      <Button\r\n        size=\"sm\"\r\n        title={\r\n          inputValue\r\n            ? `click to add the tag \"${inputValue}\"`\r\n            : \"click to add a tag\"\r\n        }\r\n        type=\"button\"\r\n        onClick={() => addTag(inputValue)}\r\n      >\r\n        <Plus />\r\n      </Button>\r\n    </div>\r\n  );\r\n}\r\n\r\ntype TagsInputListProps = {\r\n  children: (value: string[]) => ReactNode;\r\n} & Omit<ComponentProps<\"ul\">, \"children\">;\r\n\r\nfunction TagsInputList({ children, className, ...props }: TagsInputListProps) {\r\n  const { value } = useTagsInput();\r\n\r\n  return (\r\n    <ul className={cn(\"flex flex-wrap gap-2\", className)} {...props}>\r\n      {children(value)}\r\n    </ul>\r\n  );\r\n}\r\n\r\ntype TagsInputTagProps = {\r\n  value: TagsInputContextType[\"value\"][number];\r\n} & ComponentProps<\"li\">;\r\n\r\nfunction TagsInputTag({\r\n  children,\r\n  value,\r\n  className,\r\n  ...props\r\n}: TagsInputTagProps) {\r\n  const { removeTag, value: contextValue, disabled } = useTagsInput();\r\n\r\n  function handleClick() {\r\n    const valueIndex = contextValue.indexOf(value);\r\n    if (valueIndex === -1) return;\r\n    removeTag(valueIndex);\r\n  }\r\n\r\n  return (\r\n    <li\r\n      className={cn(\r\n        \"group inline-flex items-center gap-2 rounded-md bg-primary/10 py-1 pr-1 pl-2.5 text-sm font-medium text-primary transition-colors hover:bg-primary/20\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n\r\n      <Tooltip>\r\n        <TooltipTrigger asChild>\r\n          <Button\r\n            variant=\"destructive\"\r\n            size=\"icon\"\r\n            disabled={disabled}\r\n            type=\"button\"\r\n            onClick={handleClick}\r\n            className=\"size-5\"\r\n          >\r\n            <X />\r\n          </Button>\r\n        </TooltipTrigger>\r\n        <TooltipContent>\r\n          click to remove the tag{\" \"}\r\n          <span className=\"mx-1 inline-block rounded-sm bg-muted px-2 py-1 text-muted-foreground\">\r\n            {value}\r\n          </span>\r\n        </TooltipContent>\r\n      </Tooltip>\r\n    </li>\r\n  );\r\n}\r\n\r\nfunction TagsInputInfo() {\r\n  return (\r\n    <Tooltip>\r\n      <TooltipTrigger aria-label=\"Info\">\r\n        <InfoIcon className=\"size-4\" />\r\n      </TooltipTrigger>\r\n      <TooltipContent>\r\n        <p>\r\n          Press <Kbd className=\"mx-1\">Enter</Kbd> or{\" \"}\r\n          <Kbd className=\"mx-1\">,</Kbd> to add a tag, or click the add button.\r\n        </p>\r\n      </TooltipContent>\r\n    </Tooltip>\r\n  );\r\n}\r\n\r\nfunction TagsInputErrorMessage() {\r\n  const { error, errorMessageId } = useTagsInput();\r\n\r\n  if (!error) return null;\r\n  return (\r\n    <p\r\n      id={errorMessageId}\r\n      className=\"text-sm font-medium text-destructive\"\r\n      role=\"alert\"\r\n      aria-live=\"polite\"\r\n    >\r\n      {error}\r\n    </p>\r\n  );\r\n}\r\n\r\nexport {\r\n  TagsInput,\r\n  TagsInputErrorMessage,\r\n  TagsInputInfo,\r\n  TagsInputInput,\r\n  TagsInputList,\r\n  TagsInputTag,\r\n};\r\n",
      "type": "registry:component"
    }
  ],
  "meta": {
    "url": "/snippets/components/TagsInput"
  }
}